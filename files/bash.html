<h2 id="gettingstarted">Getting started</h2>

<p>{: .-three-column}</p>

<h3 id="example">Example</h3>

<pre><code class="bash language-bash">#!/usr/bin/env bash

NAME="John"
echo "Hello $NAME!"
</code></pre>

<h3 id="variables">Variables</h3>

<pre><code class="bash language-bash">NAME="John"
echo $NAME
echo "$NAME"
echo "${NAME}!"
</code></pre>

<h3 id="stringquotes">String quotes</h3>

<pre><code class="bash language-bash">NAME="John"
echo "Hi $NAME"  #=&gt; Hi John
echo 'Hi $NAME'  #=&gt; Hi $NAME
</code></pre>

<h3 id="shellexecution">Shell execution</h3>

<pre><code class="bash language-bash">echo "I'm in $(pwd)"
echo "I'm in `pwd`"
# Same
</code></pre>

<p>See <a href="http://wiki.bash-hackers.org/syntax/expansion/cmdsubst">Command substitution</a></p>

<h3 id="conditionalexecution">Conditional execution</h3>

<pre><code class="bash language-bash">git commit &amp;&amp; git push
git commit || echo "Commit failed"
</code></pre>

<h3 id="functions-1">Functions</h3>

<p>{: id='functions-example'}</p>

<pre><code class="bash language-bash">get_name() {
  echo "John"
}

echo "You are $(get_name)"
</code></pre>

<p>See: <a href="#functions">Functions</a></p>

<h3 id="conditionals-1">Conditionals</h3>

<p>{: id='conditionals-example'}</p>

<pre><code class="bash language-bash">if [ -z "$string" ]; then
  echo "String is empty"
elif [ -n "$string" ]; then
  echo "String is not empty"
fi
</code></pre>

<p>See: <a href="#conditionals">Conditionals</a></p>

<h3 id="strictmode">Strict mode</h3>

<pre><code class="bash language-bash">set -euo pipefail
IFS=$'\n\t'
</code></pre>

<p>See: <a href="http://redsymbol.net/articles/unofficial-bash-strict-mode/">Unofficial bash strict mode</a></p>

<h3 id="braceexpansion">Brace expansion</h3>

<pre><code class="bash language-bash">echo {A,B}.js
</code></pre>

<p>| <code>{A,B}</code> | Same as <code>A B</code> |
| <code>{A,B}.js</code> | Same as <code>A.js B.js</code> |
| <code>{1..5}</code> | Same as <code>1 2 3 4 5</code> |</p>

<p>See: <a href="http://wiki.bash-hackers.org/syntax/expansion/brace">Brace expansion</a></p>

<h2 id="parameterexpansions">Parameter expansions</h2>

<p>{: .-three-column}</p>

<h3 id="basics">Basics</h3>

<pre><code class="bash language-bash">name="John"
echo ${name}
echo ${name/J/j}    #=&gt; "john" (substitution)
echo ${name:0:2}    #=&gt; "jo" (slicing)
echo ${name::2}     #=&gt; "jo" (slicing)
echo ${name::-1}    #=&gt; "joh" (slicing)
echo ${food:-Cake}  #=&gt; $food or "Cake"
</code></pre>

<pre><code class="bash language-bash">length=2
echo ${name:0:length}  #=&gt; "jo"
</code></pre>

<p>See: <a href="http://wiki.bash-hackers.org/syntax/pe">Parameter expansion</a></p>

<pre><code class="bash language-bash">STR="/path/to/foo.cpp"
echo ${STR%.cpp}    # /path/to/foo
echo ${STR%.cpp}.o  # /path/to/foo.o

echo ${STR##*.}     # cpp (extension)
echo ${STR##*/}     # foo.cpp (basepath)

echo ${STR#*/}      # path/to/foo.cpp
echo ${STR##*/}     # foo.cpp

echo ${STR/foo/bar} # /path/to/bar.cpp
</code></pre>

<pre><code class="bash language-bash">STR="Hello world"
echo ${STR:6:5}   # "world"
echo ${STR:-5:5}  # "world"
</code></pre>

<pre><code class="bash language-bash">SRC="/path/to/foo.cpp"
BASE=${STR##*/}   #=&gt; "foo.cpp" (basepath)
DIR=${SRC%$BASE}  #=&gt; "/path/to" (dirpath)
</code></pre>

<h3 id="substitution">Substitution</h3>

<p>| Code | Description |
| --- | --- |
| <code>${FOO%suffix}</code> | Remove suffix |
| <code>${FOO#prefix}</code> | Remove prefix |
| --- | --- |
| <code>${FOO%%suffix}</code> | Remove long suffix |
| <code>${FOO##prefix}</code> | Remove long prefix |
| --- | --- |
| <code>${FOO/from/to}</code> | Replace first match |
| <code>${FOO//from/to}</code> | Replace all |
| --- | --- |
| <code>${FOO/%from/to}</code> | Replace suffix |
| <code>${FOO/#from/to}</code> | Replace prefix |</p>

<h3 id="comments">Comments</h3>

<pre><code class="bash language-bash"># Single line comment
</code></pre>

<pre><code class="bash language-bash">: '
This is a
multi line
comment
'
</code></pre>

<h3 id="substrings">Substrings</h3>

<p>| <code>${FOO:0:3}</code>  | Substring <em>(position, length)</em> |
| <code>${FOO:-3:3}</code> | Substring from the right |</p>

<h3 id="length">Length</h3>

<p>| <code>${#FOO}</code> | Length of <code>$FOO</code> |</p>

<h3 id="defaultvalues">Default values</h3>

<p>| <code>${FOO:-val}</code>        | <code>$FOO</code>, or <code>val</code> if not set |
| <code>${FOO:=val}</code>        | Set <code>$FOO</code> to <code>val</code> if not set |
| <code>${FOO:+val}</code>        | <code>val</code> if <code>$FOO</code> is set |
| <code>${FOO:?message}</code>    | Show error message and exit if <code>$FOO</code> is not set |</p>

<p>The <code>:</code> is optional (eg, <code>${FOO=word}</code> works)</p>

<h2 id="loops">Loops</h2>

<p>{: .-three-column}</p>

<h3 id="basicforloop">Basic for loop</h3>

<pre><code class="bash language-bash">for i in /etc/rc.*; do
  echo $i
done
</code></pre>

<h3 id="ranges">Ranges</h3>

<pre><code class="bash language-bash">for i in {1..5}; do
    echo "Welcome $i"
done
</code></pre>

<h4 id="withstepsize">With step size</h4>

<pre><code class="bash language-bash">for i in {5..50..5}; do
    echo "Welcome $i"
done
</code></pre>

<h3 id="readinglines">Reading lines</h3>

<pre><code class="bash language-bash">cat file.txt | while read line; do
  echo $line
done
</code></pre>

<h3 id="forever">Forever</h3>

<pre><code class="bash language-bash">while true; do
  ···
done
</code></pre>

<h2 id="functions">Functions</h2>

<p>{: .-three-column}</p>

<h3 id="definingfunctions">Defining functions</h3>

<pre><code class="bash language-bash">myfunc() {
    echo "hello $1"
}
</code></pre>

<pre><code class="bash language-bash"># Same as above (alternate syntax)
function myfunc() {
    echo "hello $1"
}
</code></pre>

<pre><code class="bash language-bash">myfunc "John"
</code></pre>

<h3 id="returningvalues">Returning values</h3>

<pre><code class="bash language-bash">myfunc() {
    local myresult='some value'
    echo $myresult
}
</code></pre>

<pre><code class="bash language-bash">result=$(myfunc)
</code></pre>

<h3 id="raisingerrors">Raising errors</h3>

<pre><code class="bash language-bash">myfunc() {
  return 1
}
</code></pre>

<pre><code class="bash language-bash">if myfunc; then
  echo "success"
else
  echo "failure"
fi
</code></pre>

<h3 id="arguments">Arguments</h3>

<p>| Expression | Description                        |
| ---        | ---                                |
| <code>$#</code>       | Number of arguments                |
| <code>$*</code>       | All arguments                      |
| <code>$@</code>       | All arguments, starting from first |
| <code>$1</code>       | First argument                     |</p>

<p>See <a href="http://wiki.bash-hackers.org/syntax/shellvars#special_parameters_and_shell_variables">Special parameters</a>.</p>

<h2 id="conditionals">Conditionals</h2>

<p>{: .-three-column}</p>

<h3 id="conditions">Conditions</h3>

<p>| Condition                | Description           |
| ---                      | ---                   |
| <code>[ -z STRING ]</code>          | Empty string          |
| <code>[ -n STRING ]</code>          | Not empty string      |
| ---                      | ---                   |
| <code>[ NUM -eq NUM ]</code>        | Equal                 |
| <code>[ NUM -ne NUM ]</code>        | Not equal             |
| <code>[ NUM -lt NUM ]</code>        | Less than             |
| <code>[ NUM -le NUM ]</code>        | Less than or equal    |
| <code>[ NUM -gt NUM ]</code>        | Greater than          |
| <code>[ NUM -ge NUM ]</code>        | Greater than or equal |
| ---                      | ---                   |
| <code>[[ STRING =~ STRING ]]</code> | Regexp                |
| ---                      | ---                   |
| <code>(( NUM &lt; NUM ))</code>        | Numeric conditions    |</p>

<p>| Condition          | Description              |
| ---                | ---                      |
| <code>[ -o noclobber ]</code> | If OPTIONNAME is enabled |
| ---                | ---                      |
| <code>[ ! EXPR ]</code>       | Not                      |
| <code>[ X ] &amp;&amp; [ Y ]</code>   | And                      |
| <code>[ X ] || [ Y ]</code>   | Or                       |</p>

<h3 id="fileconditions">File conditions</h3>

<p>| Condition             | Description             |
| ---                   | ---                     |
| <code>[ -e FILE ]</code>         | Exists                  |
| <code>[ -r FILE ]</code>         | Readable                |
| <code>[ -h FILE ]</code>         | Symlink                 |
| <code>[ -d FILE ]</code>         | Directory               |
| <code>[ -w FILE ]</code>         | Writable                |
| <code>[ -s FILE ]</code>         | Size is > 0 bytes       |
| <code>[ -f FILE ]</code>         | File                    |
| <code>[ -x FILE ]</code>         | Executable              |
| ---                   | ---                     |
| <code>[ FILE1 -nt FILE2 ]</code> | 1 is more recent than 2 |
| <code>[ FILE1 -ot FILE2 ]</code> | 2 is more recent than 1 |
| <code>[ FILE1 -ef FILE2 ]</code> | Same files              |</p>

<h3 id="example-1">Example</h3>

<pre><code class="bash language-bash"># String
if [ -z "$string" ]; then
  echo "String is empty"
elif [ -n "$string" ]; then
  echo "String is not empty"
fi
</code></pre>

<pre><code class="bash language-bash"># Combinations
if [ X ] &amp;&amp; [ Y ]; then
  ...
fi
</code></pre>

<pre><code class="bash language-bash"># Regex
if [[ "A" =~ "." ]]
</code></pre>

<pre><code class="bash language-bash">if (( $a &lt; $b ))
</code></pre>

<pre><code class="bash language-bash">if [ -e "file.txt" ]; then
  echo "file exists"
fi
</code></pre>

<h2 id="arrays">Arrays</h2>

<h3 id="definingarrays">Defining arrays</h3>

<pre><code class="bash language-bash">Fruits=('Apple' 'Banana' 'Orange')
</code></pre>

<pre><code class="bash language-bash">Fruits[0]="Apple"
Fruits[1]="Banana"
Fruits[2]="Orange"
</code></pre>

<h3 id="workingwitharrays">Working with arrays</h3>

<pre><code class="bash language-bash">echo ${Fruits[0]}           # Element #0
echo ${Fruits[@]}           # All elements, space-separated
echo ${#Fruits[@]}          # Number of elements
echo ${#Fruits}             # String length of the 1st element
echo ${#Fruits[3]}          # String length of the Nth element
echo ${Fruits[@]:3:2}       # Range (from position 3, length 2)
</code></pre>

<h3 id="operations">Operations</h3>

<pre><code class="bash language-bash">Fruits=("${Fruits[@]}" "Watermelon")    # Push
Fruits=( ${Fruits[@]/Ap*/} )            # Remove by regex match
unset Fruits[2]                         # Remove one item
Fruits=("${Fruits[@]}")                 # Duplicate
Fruits=("${Fruits[@]}" "${Veggies[@]}") # Concatenate
lines=(`cat "logfile"`)                 # Read from file
</code></pre>

<h3 id="iteration">Iteration</h3>

<pre><code class="bash language-bash">for i in "${arrayName[@]}"; do
  echo $i
done
</code></pre>

<h2 id="options">Options</h2>

<h3 id="options-1">Options</h3>

<pre><code class="bash language-bash">set -o noclobber  # Avoid overlay files (echo "hi" &gt; foo)
set -o errexit    # Used to exit upon error, avoiding cascading errors
set -o pipefail   # Unveils hidden failures
set -o nounset    # Exposes unset variables
</code></pre>

<h3 id="globoptions">Glob options</h3>

<pre><code class="bash language-bash">set -o nullglob    # Non-matching globs are removed  ('*.foo' =&gt; '')
set -o failglob    # Non-matching globs throw errors
set -o nocaseglob  # Case insensitive globs
set -o globdots    # Wildcards match dotfiles ("*.sh" =&gt; ".foo.sh")
set -o globstar    # Allow ** for recursive matches ('lib/**/*.rb' =&gt; 'lib/a/b/c.rb')
</code></pre>

<p>Set <code>GLOBIGNORE</code> as a colon-separated list of patterns to be removed from glob
matches.</p>

<h2 id="history">History</h2>

<h3 id="commands">Commands</h3>

<p>| <code>history</code> | Show history |
| <code>shopt -s histverify</code> | Don't execute expanded result immediately |</p>

<h3 id="expansions">Expansions</h3>

<p>| <code>!$</code> | Expand last parameter of most recent command |
| <code>!*</code> | Expand all parameters of most recent command |
| <code>!-n</code> | Expand <code>n</code>th most recent command |
| <code>!n</code> | Expand <code>n</code>th command in history |
| <code>!&lt;command&gt;</code> | Expand most recent invocation of command <code>&lt;command&gt;</code> |</p>

<h3 id="operations-1">Operations</h3>

<p>| <code>!!:s/&lt;FROM&gt;/&lt;TO&gt;/</code> | Replace first occurrence of <code>&lt;FROM&gt;</code> to <code>&lt;TO&gt;</code> in most recent command |
| <code>!!:gs/&lt;FROM&gt;/&lt;TO&gt;/</code> | Replace all occurrences of <code>&lt;FROM&gt;</code> to <code>&lt;TO&gt;</code> in most recent command |
| <code>!$:t</code> | Expand only basename from last parameter of most recent command |
| <code>!$:h</code> | Expand only directory from last parameter of most recent command |</p>

<p><code>!!</code> and <code>!$</code> can be replaced with any valid expansion.</p>

<h3 id="slices">Slices</h3>

<p>| <code>!!:n</code> | Expand only <code>n</code>th token from most recent command (command is <code>0</code>; first param is <code>1</code>) |
| <code>!!:n-m</code> | Expand range of tokens from most recent command |
| <code>!!:n-$</code> | Expand <code>n</code>th token to last from most recent command |</p>

<p><code>!!</code> can be replaced with any valid expansion i.e. <code>!cat</code>, <code>!-2</code>, <code>!42</code>, etc.</p>

<h2 id="miscellaneous">Miscellaneous</h2>

<h3 id="numericcalculations">Numeric calculations</h3>

<pre><code class="bash language-bash">$((a + 200))      # Add 200 to $a
</code></pre>

<pre><code class="bash language-bash">$((RANDOM%=200))  # Random number 0..200
</code></pre>

<h3 id="subshells">Subshells</h3>

<pre><code class="bash language-bash">(cd somedir; echo "I'm now in $PWD")
pwd # still in first directory
</code></pre>

<h3 id="redirection">Redirection</h3>

<pre><code class="bash language-bash">python hello.py &gt; output.txt   # stdout to (file)
python hello.py &gt;&gt; output.txt  # stdout to (file), append
python hello.py 2&gt; error.log   # stderr to (file)
python hello.py 2&gt;&amp;1           # stderr to stdout
python hello.py 2&gt;/dev/null    # stderr to (null)
python hello.py &amp;&gt;/dev/null    # stdout and stderr to (null)
</code></pre>

<pre><code class="bash language-bash">python hello.py &lt; foo.txt
</code></pre>

<h3 id="inspectingcommands">Inspecting commands</h3>

<pre><code class="bash language-bash">command -V cd
#=&gt; "cd is a function/alias/whatever"
</code></pre>

<h3 id="traperrors">Trap errors</h3>

<pre><code class="bash language-bash">trap 'echo Error at about $LINENO' ERR
</code></pre>

<p>or</p>

<pre><code class="bash language-bash">traperr() {
  echo "ERROR: ${BASH_SOURCE[1]} at about ${BASH_LINENO[0]}"
}

set -o errtrace
trap traperr ERR
</code></pre>

<h3 id="caseswitch">Case/switch</h3>

<pre><code class="bash language-bash">case "$1" in
  start | up)
    vagrant up
    ;;

  *)
    echo "Usage: $0 {start|stop|ssh}"
    ;;
esac
</code></pre>

<h3 id="sourcerelative">Source relative</h3>

<pre><code class="bash language-bash">source "${0%/*}/../share/foo.sh"
</code></pre>

<h3 id="printf">printf</h3>

<pre><code class="bash language-bash">printf "Hello %s, I'm %s" Sven Olga
#=&gt; "Hello Sven, I'm Olga
</code></pre>

<h3 id="directoryofscript">Directory of script</h3>

<pre><code class="bash language-bash">DIR="${0%/*}"
</code></pre>

<h3 id="gettingoptions">Getting options</h3>

<pre><code class="bash language-bash">while [[ "$1" =~ ^- &amp;&amp; ! "$1" == "--" ]]; do case $1 in
  -V | --version )
    echo $version
    exit
    ;;
  -s | --string )
    shift; string=$1
    ;;
  -f | --flag )
    flag=1
    ;;
esac; shift; done
if [[ "$1" == '--' ]]; then shift; fi
</code></pre>

<h3 id="heredoc">Heredoc</h3>

<pre><code class="sh language-sh">cat &lt;&lt;END
hello world
END
</code></pre>

<h3 id="readinginput">Reading input</h3>

<pre><code class="bash language-bash">echo -n "Proceed? [y/n]: "
read ans
echo $ans
</code></pre>

<pre><code class="bash language-bash">read -n 1 ans    # Just one character
</code></pre>

<h3 id="specialvariables">Special variables</h3>

<p>| <code>$?</code> | Exit status of last task |
| <code>$!</code> | PID of last background task |
| <code>$$</code> | PID of shell |</p>

<p>See <a href="http://wiki.bash-hackers.org/syntax/shellvars#special_parameters_and_shell_variables">Special parameters</a>.</p>

<h2 id="alsosee">Also see</h2>

<p>{: .-one-column}</p>

<ul>
<li><a href="http://wiki.bash-hackers.org/">Bash-hackers wiki</a> <em>(bash-hackers.org)</em></li>

<li><a href="http://wiki.bash-hackers.org/syntax/shellvars">Shell vars</a> <em>(bash-hackers.org)</em></li>

<li><a href="https://learnxinyminutes.com/docs/bash/">Learn bash in y minutes</a> <em>(learnxinyminutes.com)</em></li>
</ul>